"use strict";function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(a,i){try{var o=t[a](i),c=o.value}catch(e){return void r(e)}if(!o.done)return Promise.resolve(c).then(function(e){n("next",e)},function(e){n("throw",e)});e(c)}return n("next")})}}function getElementById(e){return document.getElementById(e)}function getElementsByTagName(e){return document.getElementsByTagName(e)}function createElement(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=document.createElement(e);return""!==t&&n.setAttribute("id",t),""!==r&&(n.innerHTML=r),n}function appendElement(e,t){return e.appendChild(t)}function prependElement(e,t){e.prepend(t)}function renderEmptyElement(e){e.innerHTML=""}function renderCode(e,t){var r=!0,n=!1,a=void 0;try{for(var i=Object.keys(t)[Symbol.iterator](),o;!(r=(o=i.next()).done);r=!0){var c=o.value,s=createElement("div",t[c].filename,marked("```js\n"+t[c].raw_code+"\n```"));appendElement(e,s),hljs.highlightBlock(s.firstChild.firstChild)}}catch(e){n=!0,a=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw a}}}function renderComments(e,t){var r=!0,n=!0,a=!1,i=void 0;try{for(var o=t[Symbol.iterator](),c;!(n=(c=o.next()).done);n=!0){var s=c.value,u=createElement("div",s.id,marked(s.body));r?(prependElement(e,u),r=!1):appendElement(e,u)}}catch(e){a=!0,i=e}finally{try{!n&&o.return&&o.return()}finally{if(a)throw i}}}function clearSolution(){var e=getElementById("solutions");return renderEmptyElement(e),e}function updateActiveMenuItem(e,t){e!==t&&(getElementById("nav-chapter-"+e).classList.remove("active"),getElementById("nav-chapter-"+t).classList.add("active"))}function toggleMenu(){getElementsByTagName("nav")[0].classList.toggle("collapsed")}function toggleWaiting(e){"on"===e?getElementById("waiting").classList.remove("hidden"):getElementById("waiting").classList.add("hidden")}function prepareChapterGists(e,t){return e.filter(function(e){return e.description.substring(0,e.description.indexOf("."))==t})}!function(e){e.forEach(function(e){e.hasOwnProperty("prepend")||Object.defineProperty(e,"prepend",{configurable:!0,enumerable:!0,writable:!0,value:function e(){var t=Array.prototype.slice.call(arguments),r=document.createDocumentFragment();t.forEach(function(e){var t=e instanceof Node;r.appendChild(t?e:document.createTextNode(String(e)))}),this.insertBefore(r,this.firstChild)}})})}([Element.prototype,Document.prototype,DocumentFragment.prototype]);var apiGetJson=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function e(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,fetch(t);case 2:return r.next=4,r.sent.json();case 4:return r.abrupt("return",r.sent);case 5:case"end":return r.stop()}},e,this)}));return function t(r){return e.apply(this,arguments)}}(),apiGetText=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function e(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,fetch(t);case 2:return r.next=4,r.sent.text();case 4:return r.abrupt("return",r.sent);case 5:case"end":return r.stop()}},e,this)}));return function t(r){return e.apply(this,arguments)}}(),renderChapter=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var r,n,a,i,o,c,s,u;return regeneratorRuntime.wrap(function e(p){for(;;)switch(p.prev=p.next){case 0:for(r=clearSolution(),n=!0,a=!1,i=void 0,p.prev=4,o=t[Symbol.iterator]();!(n=(c=o.next()).done);n=!0)s=c.value,u=createElement("div",s.id),appendElement(r,u),renderCode(u,s.files),prependElement(u,createElement("h3","","Solution")),s.comments>0&&renderComments(u,s.raw_comments);p.next=12;break;case 8:p.prev=8,p.t0=p.catch(4),a=!0,i=p.t0;case 12:p.prev=12,p.prev=13,!n&&o.return&&o.return();case 15:if(p.prev=15,!a){p.next=18;break}throw i;case 18:return p.finish(15);case 19:return p.finish(12);case 20:case"end":return p.stop()}},e,this,[[4,8,12,20],[13,,15,19]])}));return function t(r){return e.apply(this,arguments)}}(),enableMenu=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var r,n,a,i,o,c,s;return regeneratorRuntime.wrap(function e(u){for(;;)switch(u.prev=u.next){case 0:for(r=0,n=!0,a=!1,i=void 0,u.prev=4,o=function e(){var t=s.value,n=t.description.substring(0,t.description.indexOf("."));if(n!=r){var a=getElementById("nav-chapter-"+n);a.classList.remove("inactive"),a.onclick=function(){loadChapter(n)},r=n}},c=t[Symbol.iterator]();!(n=(s=c.next()).done);n=!0)o();u.next=13;break;case 9:u.prev=9,u.t0=u.catch(4),a=!0,i=u.t0;case 13:u.prev=13,u.prev=14,!n&&c.return&&c.return();case 16:if(u.prev=16,!a){u.next=19;break}throw i;case 19:return u.finish(16);case 20:return u.finish(13);case 21:case"end":return u.stop()}},e,this,[[4,9,13,21],[14,,16,20]])}));return function t(r){return e.apply(this,arguments)}}(),getGists=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function e(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,apiGetJson(t);case 3:return r=n.sent,r=r.filter(function(e){return e.description.includes("(Eloquent JavaScript Solutions)")}),r.sort(function(e,t){return e.description<t.description?-1:e.description>t.description?1:0}),n.abrupt("return",r);case 9:n.prev=9,n.t0=n.catch(0),console.log(n.t0.message);case 12:case"end":return n.stop()}},e,this,[[0,9]])}));return function t(r){return e.apply(this,arguments)}}(),loadChapter=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return regeneratorRuntime.wrap(function e(n){for(;;)switch(n.prev=n.next){case 0:return toggleWaiting("on"),clearSolution(),updateActiveMenuItem(currentChapter,t),r&&toggleMenu(),n.next=6,getCodeAndComments(gists,t);case 6:renderChapter(prepareChapterGists(gists,t)),currentChapter=t,toggleWaiting("off");case 9:case"end":return n.stop()}},e,this)}));return function t(r){return e.apply(this,arguments)}}(),getCodeAndComments=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r){var n,a,i,o,c,s,u,p,f,l,d,m,v;return regeneratorRuntime.wrap(function e(h){for(;;)switch(h.prev=h.next){case 0:n=!0,a=!1,i=void 0,h.prev=3,o=t[Symbol.iterator]();case 5:if(n=(c=o.next()).done){h.next=44;break}if(s=c.value,s.description.substring(0,s.description.indexOf("."))!=r){h.next=41;break}u=!0,p=!1,f=void 0,h.prev=11,l=Object.keys(s.files)[Symbol.iterator]();case 13:if(u=(d=l.next()).done){h.next=23;break}if(m=d.value,v=s.files[m],v.hasOwnProperty("raw_code")){h.next=20;break}return h.next=19,apiGetText(v.raw_url);case 19:v.raw_code=h.sent;case 20:u=!0,h.next=13;break;case 23:h.next=29;break;case 25:h.prev=25,h.t0=h.catch(11),p=!0,f=h.t0;case 29:h.prev=29,h.prev=30,!u&&l.return&&l.return();case 32:if(h.prev=32,!p){h.next=35;break}throw f;case 35:return h.finish(32);case 36:return h.finish(29);case 37:if(!(s.comments>0)||s.hasOwnProperty("raw_comments")){h.next=41;break}return h.next=40,apiGetJson(s.comments_url);case 40:s.raw_comments=h.sent;case 41:n=!0,h.next=5;break;case 44:h.next=50;break;case 46:h.prev=46,h.t1=h.catch(3),a=!0,i=h.t1;case 50:h.prev=50,h.prev=51,!n&&o.return&&o.return();case 53:if(h.prev=53,!a){h.next=56;break}throw i;case 56:return h.finish(53);case 57:return h.finish(50);case 58:case"end":return h.stop()}},e,this,[[3,46,50,58],[11,25,29,37],[30,,32,36],[51,,53,57]])}));return function t(r,n){return e.apply(this,arguments)}}(),gistsURL="https://api.github.com/users/jonurry/gists",gists={},currentChapter=2;_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function e(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,getGists(gistsURL);case 2:return gists=t.sent,enableMenu(gists),t.next=6,loadChapter(currentChapter,!1);case 6:case"end":return t.stop()}},e,void 0)}))();
//# sourceMappingURL=./app.js.map